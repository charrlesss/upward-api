"use strict";(self.webpackChunkupward=self.webpackChunkupward||[]).push([[2738],{1957:function(e,t,n){n.d(t,{Z:function(){return d}});var i=n(1413),r=n(9439),a=n(2791),o=n(4554),l=n(7482),s=n(6212),c=n(1128),u=n(184);function d(e){var t=e.onSelectionChange,n=e.initialPage,d=void 0===n?10:n,f=e.columns,h=e.rowHeight,p=void 0===h?35:h,x=e.getRowId,v=e.rows,g=e.isLoading,m=e.mutipleSelect,Z=e.height,b=void 0===Z?"500px":Z,y=(0,c.Z)(),S=y.searchParams,j=y.setSearchParams,w=(0,a.useState)([]),C=(0,r.Z)(w,2),k=C[0],A=C[1],T=(0,a.useState)(!1),I=(0,r.Z)(T,2),D=I[0],z=I[1],B=a.useState({pageSize:parseInt(S.get("pageSize"))||100,page:parseInt(S.get("page"))||1}),E=(0,r.Z)(B,2),L=E[0],R=E[1];if((0,a.useEffect)((function(){A(""===S.get("selected")?[]:[S.get("selected")])}),[S]),(0,a.useEffect)((function(){t(k,v)}),[D]),g){var F=f.map((function(e){return"id"===e.field&&(e=(0,i.Z)((0,i.Z)({},e),{},{colSpan:4,align:"center"})),e}));return(0,u.jsx)(o.Z,{sx:{height:500,width:"100%",overflowX:"scroll",position:"absolute"},children:(0,u.jsx)(s._$,{slots:{loadingOverlay:l.Z},loading:g,rows:[{id:"Loading..."}],columns:F})})}return(0,u.jsxs)(o.Z,{sx:{height:b,width:"100%",overflowX:"scroll",position:"absolute"},children:[(0,u.jsx)("button",{id:"reset-data-grid-selection",style:{display:"none"},onClick:function(){A([])},children:"reset"}),m?(0,u.jsx)(s._$,{checkboxSelection:!0,disableRowSelectionOnClick:!0,slots:{loadingOverlay:l.Z},loading:g,rowHeight:p,rows:v,columns:f,initialState:{pagination:{paginationModel:{page:0,pageSize:d}}},pageSizeOptions:[d,25,50,100],getRowId:x}):(0,u.jsx)(s._$,{slots:{loadingOverlay:l.Z},loading:g,rowHeight:p,rows:v,columns:f,initialState:{pagination:{paginationModel:{page:0,pageSize:d}}},checkboxSelection:!0,pageSizeOptions:[d,25,50,100],onRowDoubleClick:function(e){z((function(e){return!e})),A((function(t){return t.length>0&&t[0]===e.id?[]:[e.id]}))},onRowSelectionModelChange:function(e){if(e.length>1){var n=new Set(k),i=e.filter((function(e){return!n.has(e)}));t(i,v),A(i)}else t(e,v),A(e)},disableRowSelectionOnClick:!0,rowSelectionModel:k,sx:{"& .MuiDataGrid-columnHeaderCheckbox .MuiDataGrid-columnHeaderTitleContainer":{display:"none"},"& .MuiDataGrid-row":{cursor:"pointer"}},getRowId:x,paginationModel:L,onPaginationModelChange:function(e){R(e),j((function(t){return t.set("page",e.page.toString()),t.set("pageSize",e.pageSize.toString()),t}))}})]})}},341:function(e,t,n){n.d(t,{L:function(){return u}});var i=n(9439),r=n(2791),a=n(6151),o=n(5117),l=n(3786),s=n(7),c=n(184);function u(e){var t=e.setExportMode,n=r.useState(null),u=(0,i.Z)(n,2),d=u[0],f=u[1],h=Boolean(d),p=function(){f(null)};return(0,c.jsxs)(r.Fragment,{children:[(0,c.jsx)(a.Z,{id:"basic-button","aria-controls":h?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":h?"true":void 0,onClick:function(e){f(e.currentTarget),t(!0)},variant:"contained",sx:{backgroundColor:s.Z[500],"&:hover":{backgroundColor:s.Z[600]}},children:"Export"}),(0,c.jsxs)(o.Z,{id:"basic-menu",anchorEl:d,open:h,onClose:p,MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,c.jsx)(l.Z,{onClick:p,children:"Export as Excel All Data "}),(0,c.jsxs)(l.Z,{onClick:p,children:["Export as Excel Only Data in Table"," "]}),(0,c.jsx)(l.Z,{onClick:p,children:"Print Data in Table"})]})]})}},2738:function(e,t,n){n.r(t),n.d(t,{default:function(){return G},reducer:function(){return F},setNewStateValue:function(){return N},sublineColumn:function(){return M}});var i=n(4165),r=n(5861),a=n(9439),o=n(4942),l=n(1413),s=n(2791),c=n(4554),u=n(890),d=n(8550),f=n(6151),h=n(3239),p=n(7482),x=n(8096),v=n(829),g=n(8406),m=n(3786),Z=n(2419),b=n(7247),y=n(1128),S=n(1957),j=n(4378),w=n(3380),C=n(1933),k=n(1830),A=n.n(k),T=n(9018),I=n(763),D=n(7),z=n(9823),B=n(3329),E=n(341),L=n(184),R={Line:"Vehicle",Account:"",Type:"",Rate:"0.0000"},F=function(e,t){return"UPDATE_FIELD"===t.type?(0,l.Z)((0,l.Z)({},e),{},(0,o.Z)({},t.field,t.value)):e},M=[{field:"ID",headerName:"ID",width:100},{field:"Account",headerName:"Account",flex:1},{field:"Type",headerName:"Type",flex:1},{field:"Rate",headerName:"Rate",flex:1},{field:"createdAt",headerName:"Created At",width:150}],P="subline-account";function G(){var e,t,k,G,O,q,H,_,W,Y=(0,y.Z)(),V=Y.searchParams,K=Y.setSearchParams,U=(0,s.useReducer)(F,R),Q=(0,a.Z)(U,2),$=Q[0],X=Q[1],J=(0,s.useContext)(w.V),ee=J.myAxios,te=J.user,ne=(0,s.useState)(!1),ie=(0,a.Z)(ne,2),re=ie[0],ae=ie[1],oe=(0,s.useState)(!1),le=(0,a.Z)(oe,2),se=le[0],ce=le[1],ue=(0,s.useState)(""!==V.get("selected")),de=(0,a.Z)(ue,2),fe=de[0],he=de[1],pe=(0,s.useState)(""!==V.get("selected")),xe=(0,a.Z)(pe,2),ve=xe[0],ge=xe[1],me=(0,s.useState)(""!==V.get("selected")),Ze=(0,a.Z)(me,2),be=Ze[0],ye=Ze[1],Se=(0,s.useState)([]),je=(0,a.Z)(Se,2),we=je[0],Ce=je[1],ke=(0,s.useRef)(null),Ae=(0,s.useState)(""!==V.get("selected")),Te=(0,a.Z)(Ae,2),Ie=Te[0],De=Te[1],ze=(0,C.useQueryClient)(),Be=(0,C.useQuery)({queryKey:P,queryFn:function(){return(e=e||(0,r.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.get("/reference/get-rates?ratesSearch=".concat(V.get("ratesSearch")),{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var t,n;Ce(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.rate)||void 0===n?void 0:n.rate)}}),Ee=Be.data,Le=Be.isLoading,Re=(0,C.useMutation)({mutationKey:P,mutationFn:function(e){return(t=t||(0,r.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.mode||"delete"!==t.mode){e.next=4;break}return e.next=3,ee.post("/reference/delete-rates",{ID:V.get("selected")},{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}});case 3:case 8:case 12:return e.abrupt("return",e.sent);case 4:if(!Ie){e.next=9;break}return delete t.mode,e.next=8,ee.post("/reference/update-rates",(0,l.Z)((0,l.Z)({},t),{},{ID:V.get("selected")}),{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}});case 9:return delete t.mode,e.next=12,ee.post("/reference/add-rates",t,{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){if(e.data.success)return ze.invalidateQueries(P),A().fire({position:"center",icon:"success",title:e.data.message,showConfirmButton:!1,timer:1500});A().fire({position:"center",icon:"error",title:e.data.message,showConfirmButton:!1,timer:1500})}}),Fe=Re.mutate,Me=Re.isLoading,Pe=Re.variables;(0,s.useEffect)((function(){if(""!==V.get("selected")){var e=V.get("selected"),t=new Set([e]),n=null===we||void 0===we?void 0:we.filter((function(e){return t.has(e.ID.toString())}))[0];n&&N(X,n)}}),[we,V]);var Ge=function(e){var t=e.target,n=t.name,i=t.value;"Line"===n&&X({type:"UPDATE_FIELD",field:"Type",value:""}),X({type:"UPDATE_FIELD",field:n,value:i})};var Ne=null===Ee||void 0===Ee||null===(G=Ee.data)||void 0===G||null===(O=G.rate)||void 0===O?void 0:O.type[$.Line],Oe=(0,I.throttle)((function(e){ce(!0);var t=e.target.value;K((function(e){return e.set("ratesSearch",t),e})),ee.get("/reference/search-rates?ratesSearch=".concat(t),{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}}).then((function(e){console.log(e),e.data.success&&(ce(!1),Ce(e.data.rates))}))}),300);return(0,L.jsxs)(s.Fragment,{children:[(0,L.jsx)(c.Z,{children:(0,L.jsx)(u.Z,{variant:"h5",sx:{marginBottom:"10px"},children:"Rates Details"})}),(0,L.jsxs)(c.Z,{sx:function(e){return(0,o.Z)({display:"flex",alignItems:"center",columnGap:"20px"},e.breakpoints.down("sm"),{flexDirection:"column",alignItems:"flex-start",flex:1,marginBottom:"15px"})},children:[(0,L.jsx)("div",{style:{marginTop:"10px",marginBottom:"12px",flex:1,width:"100%"},children:(0,L.jsx)(d.Z,{label:"Search",fullWidth:!0,size:"small",type:"text",value:V.get("ratesSearch"),onChange:Oe})}),re?(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"5px"},children:[(0,L.jsx)(f.Z,{variant:"outlined",color:"success",size:"small",onClick:function(){n.e(1316).then(n.bind(n,1316)).then((function(e){e.exportFunction("/reference/export-rates?ratesSearch=".concat(V.get("ratesSearch"),"&isAll=true"),"Rate-All.xlsx",ee,te)}))},children:"Export All"}),(0,L.jsx)(f.Z,{variant:"outlined",color:"success",onClick:function(){n.e(1316).then(n.bind(n,1316)).then((function(e){e.exportFunction("/reference/export-rates?ratesSearch=".concat(V.get("ratesSearch"),"&isAll=false"),"Rate-Search.xlsx",ee,te)}))},size:"small",children:"Export Table"}),(0,L.jsx)(f.Z,{variant:"outlined",color:"error",size:"small",onClick:function(){return ae(!1)},children:"Cancel"})]}):(0,L.jsx)("div",{style:{display:"flex",alignItems:"center",columnGap:"20px"},children:(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"5px"},children:[(0,L.jsx)("div",{children:(0,L.jsx)(E.L,{setExportMode:ae})}),!fe&&(0,L.jsx)(f.Z,{variant:"contained",startIcon:(0,L.jsx)(Z.Z,{}),id:"entry-header-save-button",onClick:function(){var e;ge(!0),he(!0),De(!1),K((function(e){return e.set("sublineSearch",""),e.set("selected",""),e})),null===(e=document.getElementById("reset-data-grid-selection"))||void 0===e||e.click()},children:"New"}),(0,L.jsxs)(c.Z,{sx:{position:"relative"},children:[(0,L.jsx)(f.Z,{id:"save-entry-header",color:"primary",variant:"contained",type:"submit",onClick:function(){A().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, save it!"}).then((function(e){e.isConfirmed&&(0,T.D)(300).then((function(){var e;null===(e=ke.current)||void 0===e||e.click()}))}))},disabled:Me&&void 0===Pe.mode||!fe,startIcon:(0,L.jsx)(B.Z,{}),children:"Save"}),Me&&void 0===Pe.mode&&(0,L.jsx)(h.Z,{size:24,sx:{color:D.Z[500],position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]}),fe&&(0,L.jsx)(f.Z,{variant:"contained",startIcon:(0,L.jsx)(z.Z,{}),color:"error",onClick:function(){A().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!"}).then((function(e){var t;e.isConfirmed&&(he(!1),ge(!1),ye(!1),N(X,R),null===(t=document.getElementById("reset-data-grid-selection"))||void 0===t||t.click(),De(!1),K((function(e){return e.set("sublineSearch",""),e.set("selected",""),e})))}))},children:"Cancel"}),(0,L.jsx)(f.Z,{id:"save-entry-header",variant:"contained",sx:{backgroundColor:j.Z[500],"&:hover":{backgroundColor:j.Z[600]}},disabled:!be,startIcon:(0,L.jsx)(b.Z,{}),onClick:function(){A().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(e){e.isConfirmed&&Fe({ID:V.get("selected"),mode:"delete"})}))},children:"Delete"})]})})]}),!re&&(0,L.jsxs)("form",{onSubmit:function(e){return(k=k||(0,r.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log(parseFloat($.Rate).toFixed(4)),$.Rate=parseFloat($.Rate).toFixed(4),Fe((0,l.Z)((0,l.Z)({},$),{},{mode:""}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)},children:[(0,L.jsxs)(c.Z,{sx:function(e){return(0,o.Z)({display:"flex",columnGap:"15px",flexDirection:"row"},e.breakpoints.down("md"),{flexDirection:"column",rowGap:"10px"})},children:[Le?(0,L.jsx)(p.Z,{}):(0,L.jsxs)(s.Fragment,{children:[(0,L.jsxs)(x.Z,{size:"small",fullWidth:!0,disabled:!ve||Ie,required:!0,children:[(0,L.jsx)(v.Z,{id:"Line",children:"Line"}),(0,L.jsx)(g.Z,{labelId:"Line",value:$.Line,label:"Line",name:"Line",onChange:Ge,children:null===(q=Ee.data)||void 0===q||null===(H=q.rate)||void 0===H?void 0:H.line.map((function(e,t){return(0,L.jsx)(m.Z,{value:e.Line,children:e.Line},t)}))})]}),(0,L.jsxs)(x.Z,{size:"small",fullWidth:!0,disabled:!ve||Ie,required:!0,children:[(0,L.jsx)(v.Z,{id:"Account",children:"Account"}),(0,L.jsx)(g.Z,{labelId:"Account",value:$.Account,label:"Account",name:"Account",onChange:Ge,children:null===(_=Ee.data)||void 0===_||null===(W=_.rate)||void 0===W?void 0:W.policy.map((function(e,t){return(0,L.jsx)(m.Z,{value:e.Account,children:e.Account},t)}))})]}),Ne?(0,L.jsxs)(x.Z,{size:"small",fullWidth:!0,disabled:!ve,required:!0,children:[(0,L.jsx)(v.Z,{id:"Type",children:"Type"}),(0,L.jsx)(g.Z,{labelId:"Type",value:$.Type,label:"Type",name:"Type",onChange:Ge,children:Ne.map((function(e,t){return(0,L.jsx)(m.Z,{value:e.SublineName,children:e.SublineName},t)}))})]}):(0,L.jsx)(d.Z,{fullWidth:!0,type:"text",variant:"outlined",size:"small",label:"Type",name:"Type",value:$.Type,onChange:Ge,disabled:!ve,required:!0})]}),(0,L.jsx)(d.Z,{required:!0,fullWidth:!0,type:"text",variant:"outlined",size:"small",label:"Rate",name:"Rate",value:$.Rate,onChange:Ge,disabled:!ve})]}),(0,L.jsx)("button",{ref:ke,style:{display:"none"},type:"submit"})]}),(0,L.jsx)("div",{style:{marginTop:"10px",width:"100%",position:"relative"},children:(0,L.jsx)(S.Z,{mutipleSelect:re,isLoading:Me||Le||se,dataKey:"entry",queryKey:[P],columns:M,onSelectionChange:function(e,t){if(e.length<=0)return N(X,R),K((function(e){return e.set("selected",""),e})),De(!1),ge(!1),he(!1),void ye(!1);he(!0),ye(!0),ge(!0),De(!0);var n=new Set(e),i=t.filter((function(e){return n.has(e.ID.toString())}));K((function(t){return t.set("selected",e[0]),t})),N(X,i[0])},getRowId:function(e){return e.ID.toString()},rows:we,setRows:Ce})})]})}function N(e,t){Object.entries(t).forEach((function(t){var n=(0,a.Z)(t,2),i=n[0],r=n[1];e({type:"UPDATE_FIELD",field:i,value:r})}))}},7247:function(e,t,n){var i=n(4836);t.Z=void 0;var r=i(n(5649)),a=n(184),o=(0,r.default)((0,a.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");t.Z=o},4378:function(e,t){t.Z={50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",A100:"#ff80ab",A200:"#ff4081",A400:"#f50057",A700:"#c51162"}}}]);
//# sourceMappingURL=2738.9615f732.chunk.js.map