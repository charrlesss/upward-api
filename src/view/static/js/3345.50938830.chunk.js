"use strict";(self.webpackChunkupward=self.webpackChunkupward||[]).push([[3345],{1957:function(e,t,n){n.d(t,{Z:function(){return d}});var o=n(1413),i=n(9439),r=n(2791),a=n(4554),c=n(7482),s=n(6212),l=n(1128),u=n(184);function d(e){var t=e.onSelectionChange,n=e.initialPage,d=void 0===n?10:n,f=e.columns,p=e.rowHeight,h=void 0===p?35:p,g=e.getRowId,m=e.rows,x=e.isLoading,y=e.mutipleSelect,v=e.height,w=void 0===v?"500px":v,Z=(0,l.Z)(),S=Z.searchParams,b=Z.setSearchParams,C=(0,r.useState)([]),k=(0,i.Z)(C,2),A=k[0],P=k[1],I=(0,r.useState)(!1),j=(0,i.Z)(I,2),F=j[0],M=j[1],_=r.useState({pageSize:parseInt(S.get("pageSize"))||100,page:parseInt(S.get("page"))||1}),B=(0,i.Z)(_,2),D=B[0],T=B[1];if((0,r.useEffect)((function(){P(""===S.get("selected")?[]:[S.get("selected")])}),[S]),(0,r.useEffect)((function(){t(A,m)}),[F]),x){var N=f.map((function(e){return"id"===e.field&&(e=(0,o.Z)((0,o.Z)({},e),{},{colSpan:4,align:"center"})),e}));return(0,u.jsx)(a.Z,{sx:{height:500,width:"100%",overflowX:"scroll",position:"absolute"},children:(0,u.jsx)(s._$,{slots:{loadingOverlay:c.Z},loading:x,rows:[{id:"Loading..."}],columns:N})})}return(0,u.jsxs)(a.Z,{sx:{height:w,width:"100%",overflowX:"scroll",position:"absolute"},children:[(0,u.jsx)("button",{id:"reset-data-grid-selection",style:{display:"none"},onClick:function(){P([])},children:"reset"}),y?(0,u.jsx)(s._$,{checkboxSelection:!0,disableRowSelectionOnClick:!0,slots:{loadingOverlay:c.Z},loading:x,rowHeight:h,rows:m,columns:f,initialState:{pagination:{paginationModel:{page:0,pageSize:d}}},pageSizeOptions:[d,25,50,100],getRowId:g}):(0,u.jsx)(s._$,{slots:{loadingOverlay:c.Z},loading:x,rowHeight:h,rows:m,columns:f,initialState:{pagination:{paginationModel:{page:0,pageSize:d}}},checkboxSelection:!0,pageSizeOptions:[d,25,50,100],onRowDoubleClick:function(e){M((function(e){return!e})),P((function(t){return t.length>0&&t[0]===e.id?[]:[e.id]}))},onRowSelectionModelChange:function(e){if(e.length>1){var n=new Set(A),o=e.filter((function(e){return!n.has(e)}));t(o,m),P(o)}else t(e,m),P(e)},disableRowSelectionOnClick:!0,rowSelectionModel:A,sx:{"& .MuiDataGrid-columnHeaderCheckbox .MuiDataGrid-columnHeaderTitleContainer":{display:"none"},"& .MuiDataGrid-row":{cursor:"pointer"}},getRowId:g,paginationModel:D,onPaginationModelChange:function(e){T(e),b((function(t){return t.set("page",e.page.toString()),t.set("pageSize",e.pageSize.toString()),t}))}})]})}},1582:function(e,t,n){n.d(t,{Z:function(){return f}});n(2791);var o=n(1957),i=n(8447),r=n(4554),a=n(3400),c=n(890),s=n(8550),l=n(9823),u=n(184),d={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"70%",bgcolor:"background.paper",boxShadow:24,p:4,heigth:"auto"};function f(e){var t=e.height,n=e.isLoading,f=e.queryKey,p=e.columns,h=e.onSelectionChange,g=e.setRows,m=e.rows,x=e.id,y=e.onCloseModal,v=e.showModal,w=e.onClickCloseIcon,Z=e.searchOnChange;return(0,u.jsx)(i.Z,{open:v,onClose:y,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,u.jsxs)(r.Z,{sx:d,children:[(0,u.jsx)("div",{style:{position:"absolute",top:"10px",right:"10px"},children:(0,u.jsx)(a.Z,{"aria-label":"search-client",color:"secondary",onClick:w,children:(0,u.jsx)(l.Z,{})})}),(0,u.jsx)(c.Z,{id:"modal-modal-title",variant:"h6",component:"h2",mb:2,children:"Search Clients"}),(0,u.jsx)(s.Z,{size:"small",label:"Search",sx:{marginBottom:"10px"},fullWidth:!0,onChange:Z}),(0,u.jsx)("div",{style:{position:"relative",height:"".concat(t+20,"px")},children:(0,u.jsx)(o.Z,{height:"".concat(t,"px"),mutipleSelect:!1,isLoading:n,queryKey:[f],columns:p,onSelectionChange:h,getRowId:function(e){return e["".concat(x)].toString()},rows:m,setRows:g})})]})})}},3345:function(e,t,n){n.r(t),n.d(t,{FireContext:function(){return N},default:function(){return Y},vpolicyColumn:function(){return Q}});var o=n(4165),i=n(5861),r=n(9439),a=n(4942),c=n(1413),s=n(2791),l=n(4412),u=n(7689),d=n(4554),f=n(6151),p=n(3239),h=n(7),g=n(4378),m=n(2419),x=n(3380),y=n(1933),v=n(9823),w=n(3329),Z=n(1830),S=n.n(Z),b=n(7247),C=n(8096),k=n(829),A=n(8406),P=n(3786),I=n(2326),j=n(1582),F=n(8307),M=n(184),_=[{link:"/dashboard/task/production/policy/fire",text:"Policy Information"},{link:"/dashboard/task/production/policy/fire/policy-premium",text:"Policy Premium"}],B={form_action:"REG",form_type:"COM",sub_account:"HO",client_id:"",client_name:"",client_address:"",agent_id:"",agent_name:"",agent_com:"0.00",PolicyAccount:"",PolicyNo:"",bill_no:"",DateFrom:new Date,DateTo:new Date,DateIssued:new Date,locRisk:"charles1",propertyInsured:"",construction:"",occupancy:"",boundaries:"",mortgage:"",warranties:"",insuredValue:"0.00",percentagePremium:"0.00",totalPremium:"0.00",vat:"0.00",docStamp:"0.00",localGovTaxPercent:"0.75",localGovTax:"0.00",fsTax:"0.00",totalDue:"0.00",fireActioMode:""},D="FPolicyInitialState",T=function(e,t){if("UPDATE_FIELD"===t.type){var n=(0,c.Z)((0,c.Z)({},e),{},(0,a.Z)({},t.field,t.value));return localStorage.setItem(D,JSON.stringify(n)),n}return e},N=(0,s.createContext)({}),z=(0,F.Z)(B,D),L="fire-search",R="clients",O="agents",E="fire-policy",G="fire-policy",q="fire-policy",Q=[{field:"DateIssued",headerName:"Date",width:200},{field:"PolicyNo",headerName:"Policy No",width:250},{field:"Account",headerName:"Account",width:170},{field:"client_fullname",headerName:"Full Name",flex:1}],K="vehicle-policy";function Y(){var e,t,n,c,Z,F,D,Y,H,U,V=(0,s.useReducer)(T,z),J=(0,r.Z)(V,2),$=J[0],W=J[1],X=(0,s.useContext)(x.V),ee=X.myAxios,te=X.user,ne=(0,s.useState)([]),oe=(0,r.Z)(ne,2),ie=oe[0],re=oe[1],ae=(0,s.useState)([]),ce=(0,r.Z)(ae,2),se=ce[0],le=ce[1],ue=(0,s.useState)([]),de=(0,r.Z)(ue,2),fe=de[0],pe=de[1],he=(0,s.useState)(!1),ge=(0,r.Z)(he,2),me=ge[0],xe=ge[1],ye=(0,s.useState)(!1),ve=(0,r.Z)(ye,2),we=ve[0],Ze=ve[1],Se=(0,s.useState)(!1),be=(0,r.Z)(Se,2),Ce=be[0],ke=be[1],Ae=(0,s.useState)({thirdparty:"tpl"===$.form_type.toLowerCase(),compre:"com"===$.form_type.toLowerCase()}),Pe=(0,r.Z)(Ae,2),Ie=Pe[0],je=Pe[1],Fe=(0,y.useQueryClient)(),Me=""===$.fireActioMode,_e=(0,y.useQuery)({queryKey:L,queryFn:function(){return(e=e||(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.get("/task/production/search-fire-policy?searchFirePolicy=",{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var t=e.data;pe(t.firePolicy)}}),Be=_e.isLoading,De=(0,y.useQuery)({queryKey:R,queryFn:function(){return(t=t||(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.get("/task/production/search-client-fire-policy?searchClient=",{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var t=e.data;re(t.clients)}}),Te=De.isLoading,Ne=(0,y.useQuery)({queryKey:O,queryFn:function(){return(n=n||(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.get("/task/production/search-agent-fire-policy?searchAgent=",{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var t=e.data;le(t.agents)}}),ze=Ne.isLoading,Le=(0,y.useQuery)({queryKey:E,queryFn:function(){return(c=c||(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.get("/task/production/get-fire-policy",{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}),Re=Le.data,Oe=Le.isLoading,Ee=(0,y.useMutation)({mutationKey:G,mutationFn:function(e){return(Z=Z||(0,i.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("delete"!==$.fireActioMode){e.next=4;break}return e.next=3,ee.post("/task/production/update-fire-policy",t,{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}});case 3:case 6:return e.abrupt("return",e.sent);case 4:return e.next=6,ee.post("/task/production/add-fire-policy",t,{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){return(F=F||(0,i.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t),!t.data.success){e.next=5;break}return e.next=4,$e();case 4:return e.abrupt("return",S().fire({position:"center",icon:"success",title:t.data.message,showConfirmButton:!1,timer:1500}).then((function(){Je(B,!0)})));case 5:S().fire({position:"center",icon:"error",title:t.data.message,showConfirmButton:!1,timer:1500});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}),Ge=Ee.mutate,qe=Ee.isLoading,Qe=(0,y.useMutation)({mutationKey:q,mutationFn:function(e){return(D=D||(0,i.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.post("/task/production/delete-fire-policy",t,{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){return(Y=Y||(0,i.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.data.success){e.next=4;break}return e.next=3,$e();case 3:return e.abrupt("return",S().fire({position:"center",icon:"success",title:t.data.message,showConfirmButton:!1,timer:1500}).then((function(){Je(B,!0)})));case 4:S().fire({position:"center",icon:"error",title:t.data.message,showConfirmButton:!1,timer:1500});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}),Ke=Qe.mutate,Ye=Qe.isLoading,He=function(e){var t=e.target,n=t.name,o=t.value;W({type:"UPDATE_FIELD",field:n,value:o})},Ue=function(e,t){W({type:"UPDATE_FIELD",field:t,value:e})};function Ve(){var e=parseFloat($.insuredValue),t=parseFloat($.percentagePremium),n=parseFloat($.localGovTaxPercent)/100,o=e*(t/100);Ue(e.toFixed(2),"insuredValue"),Ue(t.toFixed(2),"percentagePremium"),Ue(o.toFixed(2),"totalPremium"),Ue((.12*o).toFixed(2),"vat"),Ue((.125*o).toFixed(2),"docStamp"),Ue((n*o).toFixed(2),"localGovTax"),Ue((.02*o).toFixed(2),"fsTax"),Ue((parseFloat(o.toFixed(2))+parseFloat((.12*o).toFixed(2))+parseFloat((.125*o).toFixed(2))+parseFloat((n*o).toFixed(2))+parseFloat((.02*o).toFixed(2))).toFixed(2),"totalDue")}function Je(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.form_type=$.form_type,e.form_action=$.form_action,t||(e.fireActioMode=$.fireActioMode),Object.entries(e).forEach((function(e){var t=(0,r.Z)(e,2),n=t[0],o=t[1];Ue(o,n)}))}function $e(){return(H=H||(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([Fe.invalidateQueries(L),Fe.invalidateQueries(R),Fe.invalidateQueries(O),Fe.invalidateQueries(E),Fe.invalidateQueries(G),Fe.invalidateQueries(q)]));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Oe?(0,M.jsx)("h1",{children:"Loading...."}):(0,M.jsxs)(N.Provider,{value:{clientLoading:Te,agentLoading:ze,state:$,handleInputChange:He,customInputchange:Ue,Mortgagee:Ce,setMortgagee:ke,showField:Ie,setShowField:je,isLoading:Oe,clientRows:ie,setClientRows:re,myAxios:ee,user:te,agentRows:se,setAgentRows:le,data:Re,computation:Ve,isAddOrEditMode:Me},children:[(0,M.jsx)(l.Z,{list:_}),(0,M.jsxs)(d.Z,{sx:function(e){return(0,a.Z)({display:"flex",alignItems:"center",columnGap:"20px",marginBottom:"10px"},e.breakpoints.down("sm"),{flexDirection:"column",alignItems:"flex-start",flex:1})},children:[(0,M.jsx)("div",{style:{marginTop:"10px",marginBottom:"12px",flex:1,width:"100%"}}),(0,M.jsx)("div",{style:{display:"flex",alignItems:"center",columnGap:"20px"},children:(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"5px"},children:[""===$.fireActioMode&&(0,M.jsx)(f.Z,{variant:"contained",startIcon:(0,M.jsx)(m.Z,{}),onClick:function(){Ue("add","fireActioMode")},children:"New"}),(0,M.jsxs)(d.Z,{sx:{position:"relative"},children:[(0,M.jsx)(f.Z,{color:"primary",variant:"contained",type:"submit",onClick:function(){return""===$.client_id||null===$.client_id?S().fire("Unable to save! Invalid IDNo.","you missed the Client Id Field?","error"):""===$.PolicyAccount||null===$.PolicyAccount?S().fire("Unable to save! Please select Account.","you missed the Account Field?","error"):""===$.PolicyNo||null===$.PolicyNo?S().fire("Unable to save! Invalid Policy No.","you missed the Policy No Field?","error"):void S().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Save it!"}).then((function(e){e.isConfirmed&&(console.log($),Ge($))}))},disabled:qe||""===$.fireActioMode,startIcon:(0,M.jsx)(w.Z,{}),children:"Save"}),qe&&"add"===$.fireActioMode&&(0,M.jsx)(p.Z,{size:24,sx:{color:h.Z[500],position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]}),""!==$.fireActioMode&&(0,M.jsx)(f.Z,{variant:"contained",startIcon:(0,M.jsx)(v.Z,{}),color:"error",onClick:function(){S().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!"}).then((function(e){e.isConfirmed&&(Ue("","fireActioMode"),Je(B,!0))}))},children:"Cancel"}),(0,M.jsxs)(d.Z,{sx:{position:"relative"},children:[(0,M.jsx)(f.Z,{id:"save-entry-header",variant:"contained",sx:{backgroundColor:g.Z[500],"&:hover":{backgroundColor:g.Z[600]}},disabled:"delete"!==$.fireActioMode,startIcon:(0,M.jsx)(b.Z,{}),onClick:function(){S().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(e){e.isConfirmed&&Ke({PolicyAccount:$.PolicyAccount,PolicyNo:$.PolicyNo})}))},children:"Delete"}),Ye&&(0,M.jsx)(p.Z,{size:24,sx:{color:h.Z[500],position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]})]})})]}),(0,M.jsxs)("div",{style:{marginBottom:"5px",display:"flex",gap:"10px"},children:[(0,M.jsx)(f.Z,{size:"small",variant:"outlined",startIcon:(0,M.jsx)(I.Z,{}),onClick:function(){if(""===$.fireActioMode||null===$.fireActioMode)return xe(!0);S().fire({title:"Are you sure?",text:"Your in Add mode, If you proceed the data you input will replace existing data. Are you sure you want to continue",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"No"}).then((function(e){e.isConfirmed&&(Ue("","fireActioMode"),Je(B,!0))}))},disabled:Be||we,children:"Search Policy"}),(0,M.jsxs)(C.Z,{size:"small",sx:function(e){return{width:"150px"}},children:[(0,M.jsx)(k.Z,{id:"subAccount",children:"Sub Account"}),(0,M.jsx)(A.Z,{size:"small",labelId:"subAccount",label:"subAccount",name:"sub_account",value:$.sub_account,onChange:function(e){He(e)},children:(null===Re||void 0===Re||null===(U=Re.data)||void 0===U?void 0:U.firePolicy.sub_account).map((function(e,t){return(0,M.jsx)(P.Z,{value:e.Acronym.trim(),children:e.Acronym},t)}))})]})]}),(0,M.jsx)(u.j3,{}),(0,M.jsx)(j.Z,{showModal:me,onCloseModal:function(){xe(!1)},onClickCloseIcon:function(){xe(!1)},searchOnChange:function(e){Ze(!0),ee.get("/task/production/search-fire-policy?searchFirePolicy=".concat(e.target.value),{headers:{Authorization:"Bearer ".concat(null===te||void 0===te?void 0:te.accessToken)}}).then((function(e){if(null===e||void 0===e||!e.data.success)return alert("Error : ".concat(null===e||void 0===e?void 0:e.data.message));pe(null===e||void 0===e?void 0:e.data.firePolicy),Ze(!1)}))},height:300,isLoading:Be||we,queryKey:K,columns:Q,onSelectionChange:function(e,t){if(!(e.length<=0)){var n=new Set(e),o=t.filter((function(e){return n.has(e.PolicyNo.toString())}));if(!(o.length<=0)){var i=o[0],r=i.PolicyNo,a=i.Account,c=i.DateFrom,s=i.DateTo,l=i.BillNo,u=i.Percentage,d=i.Location,f=i.InsuredValue,p=i.PropertyInsured,h=i.Constraction,g=i.Occupancy,m=i.Boundaries,x=i.Mortgage,y=i.Warranties,v=i.IDNo,w=i.SubAcct,Z=i.DateIssued,S=i.AgentID,b=i.AgentCom,C=i.client_fullname,k=i.address,A=i.agent_fullname;Ue(w,"sub_account"),Ue(v,"client_id"),Ue(C,"client_name"),Ue(k,"client_address"),Ue(S,"agent_id"),Ue(A,"agent_name"),Ue(b,"agent_com"),Ue(a,"PolicyAccount"),Ue(r,"PolicyNo"),Ue(l,"bill_no"),Ue(c,"DateFrom"),Ue(s,"DateTo"),Ue(Z,"DateIssued"),Ue(d,"locRisk"),Ue(p,"propertyInsured"),Ue(h,"construction"),Ue(g,"occupancy"),Ue(m,"boundaries"),Ue(x,"mortgage"),Ue(y,"warranties"),$.insuredValue=f,$.percentagePremium=u,Ve(),Ue("delete","fireActioMode"),xe(!1)}}},id:"PolicyNo",rows:fe,setRows:pe})]})}},4412:function(e,t,n){n.d(t,{Z:function(){return l}});var o=n(3517),i=n(7689),r=n(1087),a=n(8333),c=n(1128),s=n(184);function l(e){var t=e.list,n=(0,i.TH)(),l=(0,c.Z)().searchParams;return(0,s.jsx)("div",{role:"presentation",onClick:function(e){e.preventDefault()},children:(0,s.jsx)(o.Z,{separator:(0,s.jsx)(a.Z,{fontSize:"small"}),"aria-label":"breadcrumb",children:t.map((function(e,t){return(0,s.jsx)(r.rU,{to:e.link+"?drawer=".concat(l.get("drawer"),"&pageSize=").concat(l.get("pageSize")),style:{textDecoration:"none",color:e.link===n.pathname?"#f97316":"black"},children:e.text},t)}))})})}},8307:function(e,t,n){function o(e,t){var n=JSON.stringify(e),o=localStorage.getItem(t),i=o||n;localStorage.setItem(t,i);return["VPolicyInitialState","BPolicyInitialState","FPolicyInitialState","MPolicyInitialState","MSPRPolicyInitialState","PAPolicyInitialState","CGLPolicyInitialState"].forEach((function(e){e!==t&&localStorage.removeItem(e)})),localStorage.getItem(t)?JSON.parse(localStorage.getItem(t)):e}n.d(t,{Z:function(){return o}})}}]);
//# sourceMappingURL=3345.50938830.chunk.js.map