"use strict";(self.webpackChunkupward=self.webpackChunkupward||[]).push([[9611],{1957:function(e,t,n){n.d(t,{Z:function(){return d}});var i=n(1413),r=n(9439),o=n(2791),a=n(4554),l=n(7482),s=n(6212),c=n(1128),u=n(184);function d(e){var t=e.onSelectionChange,n=e.initialPage,d=void 0===n?10:n,p=e.columns,f=e.rowHeight,h=void 0===f?35:f,x=e.getRowId,m=e.rows,g=e.isLoading,v=e.mutipleSelect,Z=e.height,S=void 0===Z?"500px":Z,b=(0,c.Z)(),C=b.searchParams,w=b.setSearchParams,y=(0,o.useState)([]),j=(0,r.Z)(y,2),k=j[0],T=j[1],I=(0,o.useState)(!1),E=(0,r.Z)(I,2),P=E[0],B=E[1],D=o.useState({pageSize:parseInt(C.get("pageSize"))||100,page:parseInt(C.get("page"))||1}),z=(0,r.Z)(D,2),N=z[0],A=z[1];if((0,o.useEffect)((function(){T(""===C.get("selected")?[]:[C.get("selected")])}),[C]),(0,o.useEffect)((function(){t(k,m)}),[P]),g){var F=p.map((function(e){return"id"===e.field&&(e=(0,i.Z)((0,i.Z)({},e),{},{colSpan:4,align:"center"})),e}));return(0,u.jsx)(a.Z,{sx:{height:500,width:"100%",overflowX:"scroll",position:"absolute"},children:(0,u.jsx)(s._$,{slots:{loadingOverlay:l.Z},loading:g,rows:[{id:"Loading..."}],columns:F})})}return(0,u.jsxs)(a.Z,{sx:{height:S,width:"100%",overflowX:"scroll",position:"absolute"},children:[(0,u.jsx)("button",{id:"reset-data-grid-selection",style:{display:"none"},onClick:function(){T([])},children:"reset"}),v?(0,u.jsx)(s._$,{checkboxSelection:!0,disableRowSelectionOnClick:!0,slots:{loadingOverlay:l.Z},loading:g,rowHeight:h,rows:m,columns:p,initialState:{pagination:{paginationModel:{page:0,pageSize:d}}},pageSizeOptions:[d,25,50,100],getRowId:x}):(0,u.jsx)(s._$,{slots:{loadingOverlay:l.Z},loading:g,rowHeight:h,rows:m,columns:p,initialState:{pagination:{paginationModel:{page:0,pageSize:d}}},checkboxSelection:!0,pageSizeOptions:[d,25,50,100],onRowDoubleClick:function(e){B((function(e){return!e})),T((function(t){return t.length>0&&t[0]===e.id?[]:[e.id]}))},onRowSelectionModelChange:function(e){if(e.length>1){var n=new Set(k),i=e.filter((function(e){return!n.has(e)}));t(i,m),T(i)}else t(e,m),T(e)},disableRowSelectionOnClick:!0,rowSelectionModel:k,sx:{"& .MuiDataGrid-columnHeaderCheckbox .MuiDataGrid-columnHeaderTitleContainer":{display:"none"},"& .MuiDataGrid-row":{cursor:"pointer"}},getRowId:x,paginationModel:N,onPaginationModelChange:function(e){A(e),w((function(t){return t.set("page",e.page.toString()),t.set("pageSize",e.pageSize.toString()),t}))}})]})}},341:function(e,t,n){n.d(t,{L:function(){return u}});var i=n(9439),r=n(2791),o=n(6151),a=n(5117),l=n(3786),s=n(7),c=n(184);function u(e){var t=e.setExportMode,n=r.useState(null),u=(0,i.Z)(n,2),d=u[0],p=u[1],f=Boolean(d),h=function(){p(null)};return(0,c.jsxs)(r.Fragment,{children:[(0,c.jsx)(o.Z,{id:"basic-button","aria-controls":f?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":f?"true":void 0,onClick:function(e){p(e.currentTarget),t(!0)},variant:"contained",sx:{backgroundColor:s.Z[500],"&:hover":{backgroundColor:s.Z[600]}},children:"Export"}),(0,c.jsxs)(a.Z,{id:"basic-menu",anchorEl:d,open:f,onClose:h,MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,c.jsx)(l.Z,{onClick:h,children:"Export as Excel All Data "}),(0,c.jsxs)(l.Z,{onClick:h,children:["Export as Excel Only Data in Table"," "]}),(0,c.jsx)(l.Z,{onClick:h,children:"Print Data in Table"})]})]})}},3600:function(e,t,n){n.r(t),n.d(t,{ctplColumn:function(){return D},default:function(){return N},reducer:function(){return B},setNewStateValue:function(){return A}});var i=n(4165),r=n(5861),o=n(9439),a=n(4942),l=n(1413),s=n(2791),c=n(4554),u=n(890),d=n(8550),p=n(6151),f=n(3239),h=n(7482),x=n(5712),m=n(2419),g=n(1128),v=n(1957),Z=n(3380),S=n(1933),b=n(1830),C=n.n(b),w=n(9018),y=n(763),j=n(7),k=n(9823),T=n(3329),I=n(341),E=n(184),P={Prefix:"",NumSeriesFrom:0,NumSeriesTo:0,Cost:"0.00",ctplType:""},B=function(e,t){return"UPDATE_FIELD"===t.type?(0,l.Z)((0,l.Z)({},e),{},(0,a.Z)({},t.field,t.value)):e},D=[{field:"Prefix",headerName:"Prefix",width:150},{field:"NumSeriesFrom",headerName:"NumSeriesFrom",flex:1},{field:"NumSeriesTo",headerName:"NumSeriesTo",flex:1},{field:"Cost",headerName:"Cost",flex:1},{field:"CreatedBy",headerName:"Created By",width:250},{field:"createdAt",headerName:"Created At",width:150}],z="ctpl";function N(){var e,t,b,N,F,L=(0,g.Z)(),M=L.searchParams,R=L.setSearchParams,O=(0,s.useReducer)(B,P),G=(0,o.Z)(O,2),_=G[0],q=G[1],H=(0,s.useContext)(Z.V),U=H.myAxios,K=H.user,W=(0,s.useState)(!1),Y=(0,o.Z)(W,2),Q=Y[0],$=Y[1],V=(0,s.useState)(!1),X=(0,o.Z)(V,2),J=X[0],ee=X[1],te=(0,s.useState)(""!==M.get("selected")),ne=(0,o.Z)(te,2),ie=ne[0],re=ne[1],oe=(0,s.useState)(""!==M.get("selected")),ae=(0,o.Z)(oe,2),le=ae[0],se=ae[1],ce=(0,s.useState)(""!==M.get("selected")),ue=(0,o.Z)(ce,2),de=(ue[0],ue[1]),pe=(0,s.useState)([]),fe=(0,o.Z)(pe,2),he=fe[0],xe=fe[1],me=(0,s.useRef)(null),ge=(0,s.useState)(""!==M.get("selected")),ve=(0,o.Z)(ge,2),Ze=ve[0],Se=ve[1],be=(0,S.useQueryClient)(),Ce=(0,S.useQuery)({queryKey:z,queryFn:function(){return(e=e||(0,r.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.get("/reference/get-ctpl?ctplSearch=".concat(M.get("ctplSearch")),{headers:{Authorization:"Bearer ".concat(null===K||void 0===K?void 0:K.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){console.log(e),xe(null===e||void 0===e?void 0:e.data.ctpl.ctpl)}}),we=Ce.data,ye=Ce.isLoading,je=(0,S.useMutation)({mutationKey:z,mutationFn:function(e){return(t=t||(0,r.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.mode||"delete"!==t.mode){e.next=4;break}return e.next=3,U.post("/reference/delete-ctpl",{ctplId:M.get("selected")},{headers:{Authorization:"Bearer ".concat(null===K||void 0===K?void 0:K.accessToken)}});case 3:case 8:case 12:return e.abrupt("return",e.sent);case 4:if(!Ze){e.next=9;break}return delete t.mode,e.next=8,U.post("/reference/update-ctpl",(0,l.Z)((0,l.Z)({},t),{},{ctplId:M.get("selected")}),{headers:{Authorization:"Bearer ".concat(null===K||void 0===K?void 0:K.accessToken)}});case 9:return delete t.mode,e.next=12,U.post("/reference/add-ctpl",t,{headers:{Authorization:"Bearer ".concat(null===K||void 0===K?void 0:K.accessToken)}});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){if(e.data.success)return be.invalidateQueries(z),C().fire({position:"center",icon:"success",title:e.data.message,showConfirmButton:!1,timer:1500});C().fire({position:"center",icon:"error",title:e.data.message,showConfirmButton:!1,timer:1500})}}),ke=je.mutate,Te=je.isLoading,Ie=je.variables;(0,s.useEffect)((function(){if(""!==M.get("selected")){var e=M.get("selected"),t=new Set([e]),n=null===he||void 0===he?void 0:he.filter((function(e){return t.has(e.ctplId.toString())}))[0];n&&A(q,n)}}),[he,M]);var Ee=function(e){var t=e.target,n=t.name,i=t.value;"Line"===n&&q({type:"UPDATE_FIELD",field:"Type",value:""}),q({type:"UPDATE_FIELD",field:n,value:i})};var Pe=(0,y.throttle)((function(e){ee(!0);var t=e.target.value;R((function(e){return e.set("ctplSearch",t),e})),U.get("/reference/search-ctpl?ctplSearch=".concat(t),{headers:{Authorization:"Bearer ".concat(null===K||void 0===K?void 0:K.accessToken)}}).then((function(e){e.data.success&&(ee(!1),xe(e.data.ctpl))}))}),300);return(0,E.jsxs)(s.Fragment,{children:[(0,E.jsx)(c.Z,{children:(0,E.jsx)(u.Z,{variant:"h5",sx:{marginBottom:"10px"},children:"Rates Details"})}),(0,E.jsxs)(c.Z,{sx:function(e){return(0,a.Z)({display:"flex",alignItems:"center",columnGap:"20px"},e.breakpoints.down("sm"),{flexDirection:"column",alignItems:"flex-start",flex:1,marginBottom:"15px"})},children:[(0,E.jsx)("div",{style:{marginTop:"10px",marginBottom:"12px",flex:1,width:"100%"},children:(0,E.jsx)(d.Z,{label:"Search",fullWidth:!0,size:"small",type:"text",value:M.get("ctplSearch"),onChange:Pe})}),Q?(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"5px"},children:[(0,E.jsx)(p.Z,{variant:"outlined",color:"success",size:"small",onClick:function(){n.e(1316).then(n.bind(n,1316)).then((function(e){e.exportFunction("/reference/export-ctpl?ctplSearch=".concat(M.get("ctplSearch"),"&isAll=true"),"CTPL-All.xlsx",U,K)}))},children:"Export All"}),(0,E.jsx)(p.Z,{variant:"outlined",color:"success",onClick:function(){n.e(1316).then(n.bind(n,1316)).then((function(e){e.exportFunction("/reference/export-ctpl?ctplSearch=".concat(M.get("ctplSearch"),"&isAll=false"),"CTPL-Search.xlsx",U,K)}))},size:"small",children:"Export Table"}),(0,E.jsx)(p.Z,{variant:"outlined",color:"error",size:"small",onClick:function(){return $(!1)},children:"Cancel"})]}):(0,E.jsx)("div",{style:{display:"flex",alignItems:"center",columnGap:"20px"},children:(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"5px"},children:[(0,E.jsx)("div",{children:(0,E.jsx)(I.L,{setExportMode:$})}),!ie&&(0,E.jsx)(p.Z,{variant:"contained",startIcon:(0,E.jsx)(m.Z,{}),id:"entry-header-save-button",onClick:function(){var e;se(!0),re(!0),Se(!1),R((function(e){return e.set("sublineSearch",""),e.set("selected",""),e})),null===(e=document.getElementById("reset-data-grid-selection"))||void 0===e||e.click()},children:"New"}),(0,E.jsxs)(c.Z,{sx:{position:"relative"},children:[(0,E.jsx)(p.Z,{id:"save-entry-header",color:"primary",variant:"contained",type:"submit",onClick:function(){C().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, save it!"}).then((function(e){e.isConfirmed&&(0,w.D)(300).then((function(){var e;null===(e=me.current)||void 0===e||e.click()}))}))},disabled:Te&&void 0===Ie.mode||!ie,startIcon:(0,E.jsx)(T.Z,{}),children:"Save"}),Te&&void 0===Ie.mode&&(0,E.jsx)(f.Z,{size:24,sx:{color:j.Z[500],position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]}),ie&&(0,E.jsx)(p.Z,{variant:"contained",startIcon:(0,E.jsx)(k.Z,{}),color:"error",onClick:function(){C().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!"}).then((function(e){var t;e.isConfirmed&&(re(!1),se(!1),de(!1),A(q,P),null===(t=document.getElementById("reset-data-grid-selection"))||void 0===t||t.click(),Se(!1),R((function(e){return e.set("sublineSearch",""),e.set("selected",""),e})))}))},children:"Cancel"})]})})]}),!Q&&(0,E.jsxs)("form",{onSubmit:function(e){return(b=b||(0,r.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),_.Cost=parseFloat(_.Cost).toFixed(2),ke((0,l.Z)((0,l.Z)({},_),{},{mode:""}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},children:[(0,E.jsxs)(c.Z,{sx:function(e){return(0,a.Z)({display:"flex",columnGap:"15px",flexDirection:"row"},e.breakpoints.down("md"),{flexDirection:"column",rowGap:"10px"})},children:[ye?(0,E.jsx)(h.Z,{}):(0,E.jsx)(x.Z,{disabled:!le,value:_.Prefix,onChange:function(e,t){!function(e){var t=e.name,n=e.value;q({type:"UPDATE_FIELD",field:t,value:n})}({name:"Prefix",value:t})},size:"small",freeSolo:!0,disableClearable:!0,options:null===(N=we.data)||void 0===N||null===(F=N.ctpl)||void 0===F?void 0:F.prefix.map((function(e){return e.prefixName})),getOptionLabel:function(e){return e},sx:function(e){return(0,a.Z)({width:500},e.breakpoints.down("md"),{width:"100%"})},renderInput:function(e){return(0,E.jsx)(d.Z,(0,l.Z)((0,l.Z)({},e),{},{label:"Prefix",name:"Prefix",InputProps:(0,l.Z)((0,l.Z)({},e.InputProps),{},{type:"search"}),onChange:Ee}))}}),(0,E.jsx)(d.Z,{required:!0,fullWidth:!0,type:"number",variant:"outlined",size:"small",label:"NumSeriesFrom",name:"NumSeriesFrom",value:_.NumSeriesFrom,onChange:Ee,disabled:!le}),(0,E.jsx)(d.Z,{required:!0,fullWidth:!0,type:"number",variant:"outlined",size:"small",label:"NumSeriesTo",name:"NumSeriesTo",value:_.NumSeriesTo,onChange:Ee,disabled:!le}),(0,E.jsx)(d.Z,{required:!0,fullWidth:!0,type:"text",variant:"outlined",size:"small",label:"Cost",name:"Cost",value:_.Cost,onChange:Ee,disabled:!le})]}),(0,E.jsx)("button",{ref:me,style:{display:"none"},type:"submit"})]}),(0,E.jsx)("div",{style:{marginTop:"10px",width:"100%",position:"relative"},children:(0,E.jsx)(v.Z,{mutipleSelect:Q,isLoading:Te||ye||J,dataKey:"entry",queryKey:[z],columns:D,onSelectionChange:function(e,t){if(e.length<=0)return A(q,P),R((function(e){return e.set("selected",""),e})),Se(!1),se(!1),re(!1),void de(!1);re(!0),de(!0),se(!0),Se(!0);var n=new Set(e),i=t.filter((function(e){return n.has(e.ctplId.toString())}));R((function(t){return t.set("selected",e[0]),t})),A(q,i[0])},getRowId:function(e){return e.ctplId.toString()},rows:he,setRows:xe})})]})}function A(e,t){Object.entries(t).forEach((function(t){var n=(0,o.Z)(t,2),i=n[0],r=n[1];e({type:"UPDATE_FIELD",field:i,value:r})}))}}}]);
//# sourceMappingURL=9611.da10646b.chunk.js.map